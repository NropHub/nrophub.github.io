<div id="nobox" style="position:fixed;left:0px;top:0px;width:100%;height:100%;background:white;display:none">
    <center>
        <h1>Webview throws exception</h1>
        <hr>
        依赖项 Webbox 不存在！
    </center>
</div>
<script>
    图片数量 = 25
    最新版=1
    dom={
        get:function(id){
            return document.getElementById(id)
        },
        ls:{
            get:function(item){
                var v=localStorage.getItem(item)
                if(v==null||v==undefined){
                    v=""
                }
                return v
            },
            set:function(item,value){
                localStorage.setItem(item,value)
            }
        }
    }
    keys=[
            "dev",
            "AjNc7WDtjez6QFjS",
            "ylDsS7sInQybikPR",
            "UzeiiG2p2Nk2qUHm",
            "W6Lhv4F148lLdfsg",
            "gPbSvrSoP4Uj7Ziw",
            "IDg6x1dsyUl28mGD",
            "UTARdZhD46qeakXa",
            "OSyvKlwhZpU3TQG5",
            "H68Q4ODpLcQ8DdCi",
            "kPbSq6I5GIz6Dva3"
        ]
    progfade=200
    function 获取参数() {  

   var url = location.search;
   
   //获取url中"?"符后的字串  
   
   var theRequest = new Object(); 
   
   if (url.indexOf("?") != -1) { 
   
      var str = url.substr(1); 
      
      strs = str.split("&");  
      
      for(var i = 0; i < strs.length; i ++) {  
         theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
         
      }  
   }  
   return theRequest;  
   
}  
    参数=获取参数()
    if(navigator.userAgent!="HTML/WebView app/webbox webbox/1.1"&&参数["dev"]!=1&&参数["VE"]!=1){
        dom.get("nobox").style.display="block"
        nobox=true
    }
</script>
<!doctype html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" />
    <script>
        if(nobox==true){
            window.stop()
        }
    </script>
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <!-- MDUI CSS -->
    <link rel="stylesheet" href="mdui/css/mdui.min.css" />
    
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <!--script src="mdui/js/mdui.min.js"></script-->
    <title>NropHub</title>
    <style>
        body{
            margin:8px;
        }
        #prog{
            position:fixed;
            left:0px;
            top:0px;
            width:100%;
            z-index:5000;
            background:;
        }
        #prog>*{
            background:orange;
        }
        .contents{
            width:100%;
            overflow:auto;
            text-align:center;
        }
        *{
            user-select:none;
        }
        .rang{
            z-index:900;
            margin:0px 16px 0px 16px;
        }
    </style>
</head>

<body class="mdui-theme-primary-teal mdui-theme-accent-orange mdui-appbar-with-toolbar mdui-appbar-with-tab">
    <div class="mdui-appbar mdui-appbar-fixed">
        <div class="mdui-toolbar mdui-color-theme">
            <!--a href="javascript:;" class="mdui-btn mdui-btn-icon">
                <i class="mdui-icon material-icons">menu</i>
            </a-->
            <a href="javascript:;" id="title" class="mdui-typo-title">NropHub</a>
            <div class="mdui-toolbar-spacer"></div>
            <a href="javascript:init();" class="mdui-btn mdui-btn-icon">
                <i class="mdui-icon material-icons">refresh</i>
            </a>
            <a mdui-dialog="{target: '#dia-info'}" href="javascript:;" class="mdui-btn mdui-btn-icon">
                <i class="mdui-icon material-icons">info</i>
            </a>
        </div>
        <div class="mdui-tab mdui-color-theme" mdui-tab style="padding:4px 8px 0px 8px">
            <button onclick="滑动(false)" class="mdui-btn mdui-btn-icon mdui-ripple">
                <i class="mdui-icon material-icons">keyboard_arrow_left</i>
            </button>
            <label class="mdui-slider mdui-slider-discrete rang">
                <input id="rang" type="range" step="1" min="1" max="10" value="1" onchange="切换图片(this.value)"/>
            </label>
            <button onclick="滑动(true)" class="mdui-btn mdui-btn-icon mdui-ripple">
                <i class="mdui-icon material-icons">keyboard_arrow_right</i>
            </button>
            <!--script>
                for (var i=1;i<=图片数量;i++){
                    document.write(`<a href="#tab-${i}" onclick="切换图片(${i})" id="bar-${i}" class="mdui-ripple mdui-ripple-white">${i}</a>`)
                }
            </script-->
            
        </div>
    </div>
    
    <div class="contents">
        <img id="img" width="100%">
        <div style="position:absolute;top:25%;left:25%;color:rgba(0,0,0,0.20);font-size:24px">
            NropHub
        </div>
        <div style="position:absolute;bottom:33%;right:25%;color:rgba(255,255,255,0.20);font-size:24px">
            NropHub
        </div>
    </div>
    
    <div class="mdui-progress" id="prog">
  <div class="mdui-progress-indeterminate"></div>
    </div>
    
    <div class="mdui-dialog" id="dia-info" style="padding:8px">
        <h2>关于</h2>
        <p>NropHub 版权所有</p>
        <button class="mdui-btn-block mdui-btn mdui-color-theme-accent mdui-ripple mdui-btn-raised" onclick="检查更新()">检查更新</button>
        <h2>信息</h2>
        <p>
            运行环境:<script>if(参数["_IsInWebbox"]=="1"){document.write("Web box")}else{document.write("浏览器")}</script><br>
            用户代理:HTTP/1.0<script>//document.write(navigator.userAgent)</script><br>
            插件版本:<script>document.write(参数["_PluginVersion"])</script><br>
            设备标识符:<script>document.write(参数["_AndroidID"])</script>
        </p>
        <h2>激活</h2>
        <p>
            <button class="mdui-btn-block mdui-btn mdui-color-theme-accent mdui-ripple mdui-btn-raised" onclick="login()" id="login">激活</button>
            <span id="jhm" style="display:none"></span>
        </p>
        
        <p>&nbsp;</p>
    </div>
    <script src="mdui/js/mdui.min.js"></script>
    <script>
        function 滑动(v){
            if(v){
                if(dom.get("rang").value<图片数量){
                    dom.get("rang").value=parseInt(dom.get("rang").value) + 1
                    切换图片(dom.get("rang").value)
                }
            }
            else{
                if(dom.get("rang").value>1){
                    dom.get("rang").value=dom.get("rang").value - 1
                    切换图片(dom.get("rang").value)
                }
            }
            mdui.updateSliders()
        }
        function webbox(act){
            window.location.replace("webbox://"+act)
        }
        
        
        function 检查更新(){
            if(参数["_PluginCode"]<最新版){
                
            }
            else{
                if(参数["VE"]==1){
                    alert("浏览器环境无法检测")
                }
                else{
                    webbox("toast/已是最新版")
                }
            }
        }
        
        function 随机(min, max) {
  const floatRandom = Math.random()

  const difference = max - min

  // 介于 0 和差值之间的随机数
  const random = Math.round(difference * floatRandom)

  const randomWithinRange = random + min

  return randomWithinRange
}
        function 切换图片(i){
            if(login==true){
            $("#prog").stop()
            $("#prog").fadeIn(progfade)
            $("#img").stop()
            $("#img").fadeOut(100);
            当前图片=i
            setTimeout(function(){
                dom.get("img").src="img/"+当前图片+".png"
                dom.get("img").onload=function(){
                $("#prog").stop()
                $("#prog").fadeOut(progfade)
                $("#img").stop()
                $("#img").fadeIn(100);
                }
                dom.get("title").innerHTML="NropHub - "+i
            },100)
            }
            else{
                login()
            }
        }
        function init(){
            dom.get("rang").max=图片数量
            if(login==true){
                if(dom.ls.get("图片数量")<图片数量){
                    
                    mdui.snackbar({
  message: '更新了 '+(图片数量-dom.ls.get("图片数量"))+' 张图片'
});
                
                    
                }
                dom.ls.set("图片数量",图片数量)
                $("#prog").stop()
                $("#prog").fadeIn(progfade)
            当前图片=随机(1,图片数量);
            dom.get("rang").value=当前图片
            mdui.updateSliders()
            //alert(dom.get("rang").value)
            切换图片(当前图片)
            dom.get("img").onload=function(){
                $("#prog").stop()
                $("#prog").fadeOut(progfade)
                $("#img").stop()
                $("#img").fadeIn(100);
            }
            }
        }
        window.onload=function(){
            $("#prog").stop()
            $("#prog").fadeOut(progfade)
        }
        function login(){
            if(参数["VE"]!="1"){
        mdui.prompt("输入激活码","激活",
            function(v){
                var a=""
                for (var i=3;i<v.length;i++){
                    a=a+"*"
                }
                if(keys.indexOf(v)!=-1){
                login=true
                dom.get("jhm").style.display="inline-block"
                dom.get("jhm").innerHTML="激活码:"+v.substring(0,3)+a
                dom.get("login").style.display="none"
                webbox("toast/激活成功")
                dom.ls.set("SAC",v)
                }
                else{
                    webbox("toast/激活码错误")
                }
                dom.ls.set("SAC",v)
                init()
            },
            function(v){
                dom.ls.setItem("SAC",v)
                init()
            },
            {
                defaultValue:dom.ls.get("SAC"),
                cancelText:"",
                confirmText:"激活"
            })
            }
            else{
                var v=prompt("输入激活码",dom.ls.get("SAC"))
                var a=""
                for (var i=3;i<v.length;i++){
                    a=a+"*"
                }
                if(keys.indexOf(v)!=-1){
                login=true
                dom.get("jhm").style.display="inline-block"
                dom.get("jhm").innerHTML="激活码:"+v.substring(0,3)+a
                dom.get("login").style.display="none"
                mdui.snackbar({message: "激活成功"});
                dom.ls.set("SAC",v)
                }
                else{
                    mdui.snackbar({message: "激活码错误"});
                }
                dom.ls.set("SAC",v)
                init()
            }
        }
        login()
    </script>

    <!-- MDUI JavaScript -->
    <script src="mdui/js/mdui.min.js"></script>
</body>

</html>